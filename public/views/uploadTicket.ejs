<!-- views/uploadTicket.ejs -->
<!DOCTYPE html>
<html lang="en">
<head>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>Reticket</title>
    <link href="css/all.min.css" rel="stylesheet" type="text/css">
    <link href="https://fonts.googleapis.com/css?family=Nunito:200,200i,300,300i,400,400i,600,600i,700,700i,800,800i,900,900i" rel="stylesheet">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous" />
    <link href="css/sb-admin-2.min.css" rel="stylesheet">
    <link rel="stylesheet" href="/css/styles.css">

    <style>
        .fade-in {
            animation: fadeIn 1s ease-in;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }
    </style>

</head>
<body id="app-background-image">
    <div class="container">
        <div class="row">
            <div class="col-md-12 text-center mt-5">
                <h2 class="text-warning">Drag your ticket here:</h2>
            </div>
        </div>
        <div class="row">
            <div class="col-md-12 text-center mt-3">
                <form id="upload-ticket-form" method="post" action="/upload-ticket" enctype="multipart/form-data">
                    <div class="upload-zone" style="width: 50%; margin: 0 auto; border: 2px dashed #FFA500; min-height: 200px; line-height: 200px; text-align: center;">
                        <input type="file" id="ticket-file" name="ticketFile" style="display:none;" accept=".pdf">
                        <label for="ticket-file" class="text-warning" style="cursor: pointer;">Drop your PDF file here or click to browse</label>
                    </div>
                    <button type="submit" class="btn btn-orange mt-3">Continue</button>
                </form>
            </div>
        </div>
    </div>

    <script>
        // Get the file input and the upload zone element
        const ticketFileInput = document.getElementById('ticket-file');
        const uploadZone = document.querySelector('.upload-zone');

        // Prevent the browser's default drag and drop behavior
        ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
            document.body.addEventListener(eventName, preventDefaults, false);
        });

        function preventDefaults(e) {
            e.preventDefault();
            e.stopPropagation();
        }

        // Handle the drag and drop events on the upload zone
        ['dragenter', 'dragover'].forEach(eventName => {
            uploadZone.addEventListener(eventName, highlight, false);
        });

        ['dragleave', 'drop'].forEach(eventName => {
            uploadZone.addEventListener(eventName, unhighlight, false);
        });

        function highlight(e) {
            uploadZone.style.backgroundColor = '#ffa50033';
        }

        function unhighlight(e) {
            uploadZone.style.backgroundColor = '';
        }

        function showSuccessMessage(filename) {
            const successMessage = document.createElement('div');
            successMessage.textContent = `Loaded: ${filename}`;
            successMessage.className = 'text-warning mt-3';
            successMessage.style.opacity = 0;
            document.body.appendChild(successMessage);
            setTimeout(() => {
                successMessage.classList.add('fade-in');
            }, 100);
        }

        // Handle the file drop event
        uploadZone.addEventListener('drop', handleDrop, false);

        function handleDrop(e) {
            const dt = e.dataTransfer;
            const file = dt.files[0];

            // Check if the dropped file is a PDF
            if (file.type === 'application/pdf') {
                ticketFileInput.files = dt.files;
            } else {
                alert('Please upload a PDF file.');
            }
        }
    </script>

    <!-- Bootstrap core JavaScript-->
    <script src="script/jquery.min.js"></script>
    <script src="script/bootstrap.bundle.min.js"></script>

    <!-- Core plugin JavaScript-->
    <script src="script/jquery.easing.min.js"></script>

    <!-- Custom scripts for all pages-->
    <script src="script/sb-admin-2.min.js"></script>

</body>
</html>
